var r={base:"/app/",main:"#app-main",index:"index",event:"component:event",templates:{},components:{},isF:l,isS:c,isE:d,isO:m};function l(e){return typeof e=="function"}function c(e){return typeof e=="string"}function m(e){return typeof e=="object"&&e}function d(e){return e instanceof HTMLElement?e:void 0}function w(e){return e.toLowerCase().replace(/-(\w)/g,(t,i)=>i.toUpperCase())}r.noop=()=>{};r.log=(...e)=>console.log(...e);r.trace=(...e)=>{r.debug&&r.log(...e)};r.call=(e,t,...i)=>{if(l(e))return e(t,...i);if(typeof e=="object"){if(l(t))return t.call(e,...i);if(e&&l(e[t]))return e[t].call(e,...i)}};var p={};r.on=(e,t)=>{l(t)&&(p[e]||(p[e]=[]),p[e].push(t))};r.once=(e,t)=>{if(!l(t))return;let i=(...n)=>{r.off(e,i),t(...n)};r.on(e,i)};r.only=(e,t)=>{p[e]=l(t)?[t]:[]};r.off=(e,t)=>{if(!p[e]||!t)return;let i=p[e].indexOf(t);if(i>-1)return p[e].splice(i,1)};r.emit=(e,...t)=>{if(r.trace("emit:",e,...t),p[e])for(let i of p[e])i(...t);else if(c(e)&&e.endsWith(":*")){e=e.slice(0,-1);for(let i in p)if(i.startsWith(e))for(let n of p[i])n(...t)}};r.$param=(e,t)=>new URLSearchParams(location.search).get(e)||t||"";var x=e=>c(e)?e.replace(/#([^\s"#']+)/g,(t,i)=>`#${CSS.escape(i)}`):"";r.$=(e,t)=>(d(t)||document).querySelector(x(e));r.$all=(e,t)=>(d(t)||document).querySelectorAll(x(e));r.$event=(e,t,i={})=>d(e)&&e.dispatchEvent(new CustomEvent(t,{detail:i,bubbles:!0,composed:!0,cancelable:!0}));r.$on=(e,t,i,...n)=>l(i)&&e.addEventListener(t,i,...n);r.$off=(e,t,i,...n)=>l(i)&&e.removeEventListener(t,i,...n);r.$attr=(e,t,i)=>{if(c(e)&&e&&(e=r.$(e)),!!d(e))return i===void 0?e.getAttribute(t):i===null?e.removeAttribute(t):e.setAttribute(t,i)};r.$empty=(e,t)=>{if(c(e)&&e&&(e=r.$(e)),!!d(e)){for(;e.firstChild;){let i=e.firstChild;i.remove(),r.call(t,i)}return e}};r.$elem=(e,...t)=>{var i=document.createElement(e),n,o;m(t[0])&&(t=Object.entries(t[0]).flatMap(s=>s));for(let s=0;s<t.length-1;s+=2)n=t[s],o=t[s+1],c(n)&&(l(o)?r.$on(i,n,o):n.startsWith(".")?i.style[n.substr(1)]=o:n.startsWith(":")?i[n.substr(1)]=o:n.startsWith("data-")?i.dataset[w(n.substr(5))]=o:n=="text"?i.textContent=o||"":i.setAttribute(n,o??""));return i};r.$parse=(e,t)=>(e=new window.DOMParser().parseFromString(e||"","text/html").body,t?Array.from(e.childNodes):e);var y=[];r.$ready=e=>{if(y.push(e),document.readyState!="loading")for(;y.length;)setTimeout(r.call,0,y.shift())};r.$on(window,"DOMContentLoaded",()=>{for(;y.length;)setTimeout(r.call,0,y.shift())});r.parsePath=e=>{var t={name:"",params:{}},i,n=window.location;if(!c(e))return t;var o=r.base;e.startsWith(n.origin)&&(e=e.substr(n.origin.length)),e.includes("://")&&(e=e.replace(/^(.*:\/\/[^\/]*)/,"")),e.startsWith(o)&&(e=e.substr(o.length)),e.startsWith("/")&&(e=e.substr(1)),e==o.slice(1,-1)&&(e="");let s=e.indexOf("?");if(s>0&&(i=e.substr(s+1,1024),t.name=e=e.substr(0,s)),e.includes("/")){e=e.split("/").slice(0,5),t.name=e.shift();for(let a=0;a<e.length;a++)e[a]&&(t.params[`param${a+1}`]=e[a])}else t.name=e||"";if(i)for(let[a,f]of new URLSearchParams(i).entries())t.params[a]=f;return t};r.savePath=e=>{if(c(e)&&(e={name:e}),!!e?.name){var t=[e.name];if(e?.params)for(let i=1;i<5;i++)t.push(e.params[`param${i}`]||"");for(;!t.at(-1);)t.length--;t=t.join("/"),r.trace("savePath:",t,e),t&&window.history.pushState(null,"",window.location.origin+r.base+t)}};r.restorePath=e=>{r.trace("restorePath:",e,r.index),r.render(e,r.index)};r.start=()=>{r.on("path:save",r.savePath),r.on("path:restore",r.restorePath),r.$ready(r.restorePath.bind(r,window.location.href))};r.$on(window,"popstate",()=>r.emit("path:restore",window.location.href));var u={},A;r.plugin=(e,t)=>{if(!e||!c(e))throw Error("type must be defined");if(t){for(let n of["render","cleanup","data"])if(t[n]&&!l(t[n]))throw Error(n+" must be a function");l(t?.Component)&&(r[`${e.substr(0,1).toUpperCase()+e.substr(1).toLowerCase()}Component`]=t.Component)}var i=u[e]=u[e]||{};return t?.default&&(A=i),Object.assign(i,t)};r.$data=e=>{c(e)&&e&&(e=r.$(e));for(let t in u){if(!u[t].data)continue;let i=u[t].data(e);if(i)return i}};r.resolve=(e,t)=>{let i=r.parsePath(e);r.trace("resolve:",e,t,i);var n=i.name,o=r.templates,s=r.components,a=o[n]||document.getElementById(n)?.innerHTML;if(!a&&t&&(a=o[t]||document.getElementById(t)?.innerHTML,a&&(i.name=t)),a?.startsWith("#")?a=document.getElementById(a.substr(1))?.innerHTML:a?.startsWith("$")&&(a=o[a.substr(1)]),!!a){i.template=a;var f=s[n]||s[i.name];return c(f)&&(f=s[f]),i.component=f,i}};r.render=(e,t)=>{var i=r.resolve(e?.name||e,t);if(!i)return;var n=i.params;Object.assign(n,e?.params),r.trace("render:",e,i.name,i.params);let o=r.$(n.$target||r.main);if(o){var s=i.component?.$type||e?.plugin||n.$plugin;if(s=u[s]||A,!!s?.render){if(!n.$target||n.$target==r.main){var a={name:i.name,params:n};if(r.emit(r.event,"prepare:delete",a),a.stop)return;var f=Object.values(u);for(let $ of f.filter(E=>E.cleanup))r.call($.cleanup,o);e?.nohistory||n.$nohistory||i.component?.$nohistory||queueMicrotask(()=>{r.emit("path:save",i)})}return r.emit("component:render",i),s.render(o,i),i}}};var h="alpine",b=class e{template="";params={};static $type=h;static _id=0;constructor(t,i){this.$name=t,this.$_id=`${t}:${h}:${e._id++}`,Object.assign(this.params,i),this._handleEvent=this.handleEvent.bind(this)}init(){r.trace("init:",this.$_id),Object.assign(this.params,this.$el._x_params),r.call(this.onCreate?.bind(this)),this.params.$noevents||r.on(r.event,this._handleEvent),r.emit("component:create",{type:h,name:this.$name,component:this,element:this.$el,params:Alpine.raw(this.params)})}destroy(){r.trace("destroy:",this.$_id),r.off(r.event,this._handleEvent),r.emit("component:delete",{type:h,name:this.$name,component:this,element:this.$el,params:Alpine.raw(this.params)}),r.call(this.onDelete?.bind(this)),this.params={}}handleEvent(t,...i){if(r.trace("event:",this.$_id,...i),r.call(this.onEvent?.bind(this.$data),t,...i),!!c(t)){var n=w("on_"+t);r.call(this[n]?.bind(this.$data),...i)}}},v=class extends HTMLElement{connectedCallback(){g(this,this.getAttribute("template")||this.localName.substr(Alpine.prefixed().length))}};function g(e,t){if(c(t)&&(t=r.resolve(t),!t))return;r.$empty(e);let i=r.$parse(t.template);if(!t.component)Alpine.mutateDom(()=>{for(;i.firstChild;){let n=i.firstChild;e.appendChild(n),n.nodeType==1&&(Alpine.addScopeToNode(n,{},e),Alpine.initTree(n))}});else{Alpine.data(t.name,()=>new t.component(t.name));let n=r.$elem("div","x-data",t.name,":_x_params",t.params);for(;i.firstChild;)n.appendChild(i.firstChild);Alpine.mutateDom(()=>{e.appendChild(n),Alpine.initTree(n),delete n._x_params})}}function S(e){return d(e)||(e=r.$(r.main+" div")),e&&Alpine.closestDataStack(e)[0]}r.plugin(h,{render:g,Component:b,data:S,default:1});r.on("alpine:init",()=>{for(let[e,t]of Object.entries(r.components))t?.$type!=h||customElements.get(Alpine.prefixed(e))||(customElements.define(Alpine.prefixed(e),class extends v{}),Alpine.data(e,()=>new t(e)))});r.$on(document,"alpine:init",()=>{r.emit("alpine:init"),Alpine.magic("app",e=>r),Alpine.directive("render",(e,{modifiers:t,expression:i},{evaluate:n,cleanup:o})=>{let s=a=>{a.preventDefault(),r.render(n(i))};r.$on(e,"click",s),e.style.cursor="pointer",o(()=>{r.$off(e,"click",s)})}),Alpine.directive("template",(e,{expression:t},{effect:i,cleanup:n})=>{let o=Alpine.evaluateLater(e,t||"template"),s=()=>{Alpine.mutateDom(()=>{r.$empty(e,a=>Alpine.destroyTree(a))})};i(()=>o(a=>{a?g(e,a):s()})),n(s)})});r.fetchOpts=function(e){var t=e.headers||{},i=Object.assign({headers:t,method:e.type||"POST",cache:"default"},e.fetchOptions),n=e.data;return i.method=="GET"||i.method=="HEAD"?m(n)&&(e.url+="?"+new URLSearchParams(n).toString()):c(n)?(i.body=n,t["content-type"]=e.contentType||"application/x-www-form-urlencoded; charset=UTF-8"):n instanceof FormData?(i.body=n,delete t["content-type"]):m(n)?(i.body=JSON.stringify(n),t["content-type"]="application/json; charset=UTF-8"):n&&(i.body=n,t["content-type"]=e.contentType||"application/octet-stream"),i};r.fetch=function(e,t){try{let i=r.fetchOpts(e);window.fetch(e.url,i).then(async n=>{var o,s,a={status:n.status,headers:{},type:n.type};for(let f of n.headers)a.headers[f[0].toLowerCase()]=f[1];if(!n.ok){if(/\/json/.test(a.headers["content-type"])){let f=await n.json();o={status:n.status};for(let $ in f)o[$]=f[$]}else o={message:await n.text(),status:n.status};return r.call(t,o,s,a)}switch(e.dataType){case"text":s=await n.text();break;case"blob":s=await n.blob();break;default:s=/\/json/.test(a.headers["content-type"])?await n.json():await n.text()}r.call(t,null,s,a)}).catch(n=>{r.call(t,n)})}catch(i){r.call(t,i)}};var C=r;var k=C;export{k as default};
